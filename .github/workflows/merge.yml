name: Merge JSONs in /净化

on:
  push:
    paths:
      - '净化/*.json'
      - '!净化/合集/jh.json'  # 排除 jh.json 的变化触发
  workflow_dispatch:

jobs:
  merge-json:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: Merge JSON files
        run: |
          mkdir -p 净化/合集
          jq -s 'add' $(find 净化 -maxdepth 1 -type f -name '*.json' ! -name 'jh.json') > 净化/合集/jh.json

      - name: Commit and push changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: '自动合并净化目录下JSON文件为jh.json'
          file_pattern: '净化/合集/jh.json'