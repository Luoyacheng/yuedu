[{
  "articleStyle": 1,
  "contentBlacklist": ".*(?:pemsrv.com|mmfree3.com|magsrv.com).*,.*adcg.*gif",
  "customOrder": -10100157,
  "enableJs": true,
  "enabled": true,
  "enabledCookieJar": true,
  "header": "@js:\n(()=>{\n\tlet info=cache.getFromMemory('av18info');\nif (info) source.putLoginInfo(JSON.stringify(info)),cache.deleteMemory('av18info');\nlet headerss=gethd();\nheaderss['User-Agent']=java.getWebViewUA();\n return JSON.stringify(headerss);\n})();",
  "jsLib": "sleep=Packages.java.lang.Thread.sleep;\nu_a = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36 Edg/135.0.0.0';\nx_r_w = ''; //com.microsoft.emmx\ns_c_u_p = `\"Windows\"`;\ns_c_u = `\"Microsoft Edge\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"`;\na_l = 'zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7';\n\nfunction gethd(url='',ck='') {\n\tlet ck0 = this.source.getLoginHeader()||'';\n\tlet headerss = {\n\t\t  \t'User-Agent': u_a,\n\t\t  \t'Cookie': ck0,\n\t\t  \t'x-requested-with': x_r_w,\n     \t'Accept-Language': a_l\n    \t }\nif (ck==1&&url!='') return url+','+JSON.stringify({'headers':headerss,'webView':true});\nif (ck!='') headerss['Cookie']=ck;\nif (url=='') return headerss;\nreturn url+','+JSON.stringify({'headers':headerss});\n}\n\nfunction gets(x, r) {\nreturn r == undefined ? String(this.java.getString(x)) : String(this.java.getString(x,r));}\n\nfunction surl() {\n\tlet surl=this.source.getLoginInfoMap()['网址']+'';\n\tif (!surl||surl=='undefined') surl='https://mjv006.com';\n\treturn surl.replace(/\\/$/,'');}\n\t\nfunction skey(x) {\n\tlet ss=this.source.getLoginInfoMap()['搜索'+x]+[];\n\tif (!ss||ss=='undefined') ss= x==1?'波多':'日向';\n\treturn ss}\n\nfunction tmtz() {\n\t\tlet tmt = this.source.getLoginInfoMap()['双击跳转时间']+[];\n\t\tif (tmt>2) return tmt;\n\t\telse return '10';\n\t}\n\nfunction tkey() {\n\tlet tkey = this.source.getLoginInfoMap()['每日更新']+[];\n\tif (tkey&&tkey!='undefined') {\n\t\ttkey = tkey.replace(/^\\d{0,2}(\\d{2})[\\-\\ \\/](\\d{1,2})[-\\ \\/](\\d{1,2})$/, (mt, p1, p2, p3)=>{\n\t\t\tp1='20'+p1;\n\t\t\tp2=p2.padStart(2, '0');\n\t\t\tp3=p3.padStart(2, '0');\n\t\t\tp2>12&&(p2='012')\n\t\t\tp3>31&&(p3='031')\n\t\t\treturn p1+'-'+p2+'-'+p3;\n\t\t\t});\n\t\t\tif (!/^\\d{4}-\\d{2}-\\d{2}$/.test(tkey)) {\n\t\t\t\ttkey='';\n\t\t\t\tthis.java.toast('\\n❎请输入正确的时间格式');}\n}\nif (!tkey||tkey=='undefined') {tkey = this.java.timeFormatUTC(Date.now(),\"yyyy-MM-dd\",6*60*60*1000)+[];}\n\treturn tkey;}\n\t\nfunction rrcheck(url, webr) {\n\tconst {java, source, cookie} = this;\n\tlet webr2 = org.jsoup.Jsoup.parse(webr);\n\tlet url19 = (webr2.select('#fwin_dialog_submit').attr('onclick')+'').match(/http[^\"']+/);\nif (url19) {\n\tlet ck=\tjava.connect(url19)\n\t.headers()\n\t.values(\"Set-Cookie\");\n\tlet cks = [];\n\tfor (let char of ck) {\n\tchar=(char+'').replace(/;.+/,'');\n\tcks.push(char);}\n\tck=cks.join('; '); //带ajax得到的会话ck访问时不会有ck返回，为激活ck(主要用于不启用jar)\n//\tcookie.replaceCookie(url,ck); //不调用startBrowser，ck不会同步到内置浏览器\nck=ck||cookie.getCookie(url)+'';\n//勾选ckjar就能getck读取本次软件会话ck(重启软件失效)，setck函数才会一直保存源ck?\nck && source.putLoginHeader(ck); //ck过期时不需要更新ck，直接再激活\ncookie.setWebCookie(url,ck+''); //同步ck到内置浏览器\n\tsleep(200); //服务器记录可能需要延时\n\twebr=java.ajax(url); //访问前会执行一次请求头规则\n\t}\n\treturn java.t2s(webr)+'';\n}\n\n\nfunction gengxin(){\nconst {java, source} = this;\n\tlet url0='https://gitee.com/lyc486/yuedu2/commits/personal/订阅/18AV/18av.json?browser_history=0&page=1&per=3';\n\tlet rr0=java.get(url0,{'User-Agent': 'Mozilla/5.0 (Linux; Android 14)','X-Requested-With': 'XMLHttpRequest'}).body();\n\tlet \tgxlrr = com.jayway.jsonpath.JsonPath.read(rr0, '$.list[0:3].title');\n\tlet [gxlr, gxlr2, gxlr3] = gxlrr;\n\tlet banben =   String(source.sortUrl).match(/let banben=\"([\\d\\.]+)\"/)[1];\n\tgxlr=String(gxlr).split(/^([^\\-]+)-/);\n\tgxlr[0]=='' ? '' : gxlr=['','0',gxlr[0]];\n\tlet gxts;\n\tif (gxlr[1]>banben){gxts=['更新','0,140,186'];}\n\telse {gxts= ['导入','76,175,80'];};\n\tlet htm = `<html>\n<head>\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<title>18AV ${gxts[0]}</title>\n<style>\ntable {\n\ttext-align: center;\n\tmargin: 0 auto;\n\t}\n.ann {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\theight: 50vh;\n\t}\nbutton {\n\tbackground-color: rgb(${gxts[1]});\n\tcolor: white;\n\tborder: none;\n\tborder-radius: 4px;\n\theight: 6vh;\n\twidth: 30vw;\n\toverflow: hidden;\n\t}\nbutton span {\n  cursor: pointer;\n  display: inline-block;\n  position: relative;\n  transition: 0.4s;\n}\nbutton span:after {\n  content: '>';\n  position: absolute;\n  opacity: 0;\n  top: 0;\n  right: 30px;\n  transition: 0.2s;\n}\nbutton:active span {\n  padding-right: 20px;\n}\nbutton:active span:after {\n  opacity: 1;\n  right: -40px;\n}\n</style>\n</head>\n<body>\n<table border=\"1\" cellspacing=\"0\">\n<th colspan=\"2\">最新日志：${gxlr[2]}</th>\n<tr>\n<td>仓库版本：${gxlr[1]}</td>\n<td>本地版本：${banben}</td>\n</tr>\n<tr>\n<td colspan=\"2\" style=\"text-align: left;\">往期日志：${gxlr2}<br>　　　　　${gxlr3}</td>\n</tr>\n</table>\n<div class=\"ann\">\n<a href=\"legado://import/importonline?src=https://gitee.com/lyc486/yuedu2/raw/personal/订阅/18AV/18av.json\">\n<button><span>${gxts[0]}</span></button>\n</a>\n</div>\n<a href=\"legado://import/importonline?src=https://cdn.jsdelivr.net/gh/Luoyacheng/yuedu@personal/订阅/18AV/18av.json\" style=\"font-size: 10px;\">备用链接</a>\n</body>\n</html>`;\njava.startBrowser(`data:text/html;base64,${java.base64Encode(htm)}`,'订阅源更新');\r\n}\n\n",
  "lastUpdateTime": 1755004895159,
  "loadWithBaseUrl": true,
  "loginUi": "@js:\n`[\n    {\n        name: \"网址\",\n        type: \"text\"\n    },\n    {\n        name: \"搜索1\",\n        type: \"text\"\n    },\n    {\n        name: \"每日更新\",\n        type: \"text\"\n    },\n    \t{\n        name: \"ArtPlayer V${java.importScript('https://unpkg.com/artplayer/dist/artplayer.js').match(/artplayer.js.*v(.+)/i)[1]}\",\n        type: \"button\",\n        action: \"bfq()\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": true\n        }\n    },\n    \t{\n        name: \"订阅源版本 V${(source.sortUrl+'').substr(18,5)}\",\n        type: \"button\",\n        action: \"gengxin()\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": flase\n        }\n    },\n    \t{\n        name: \"${bfqfun('继续播放',1)?'⚪':'⚫'}继续播放\",\n        type: \"button\",\n        action: \"bfqfun('继续播放')\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": true\n        }\n    },\n    \t{\n        name: \"${bfqfun2('自动播放',1)?'⚪':'⚫'}自动播放\",\n        type: \"button\",\n        action: \"bfqfun2('自动播放')\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": flase\n        }\n    },\n    \t{\n        name: \"${bfqfun3('左右滑动等级',1)}滑动等级\",\n        type: \"button\",\n        action: \"bfqfun3('左右滑动等级',7)\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": flase\n        }\n    },\n    \t{\n        name: \"${bfqfun('显示链接',1)?'⚪':'⚫'}显示链接\",\n        type: \"button\",\n        action: \"bfqfun('显示链接')\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": flase\n        }\n    },\n    \t{\n        name: \"${bfqfun('预览截图',1)?'⚪':'⚫'}预览截图\",\n        type: \"button\",\n        action: \"bfqfun('预览截图')\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": flase\n        }\n    },\n    \t{\n        name: \"${bfqfun2('外置播放器',1)?'⚪':'⚫'}外置播放器\",\n        type: \"button\",\n        action: \"bfqfun2('外置播放器')\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": flase\n        }\n    },\n    {\n        name: \"双击跳转时间\",\n        type: \"text\"\n    },\n    {\n        name: \"自定义分类\",\n        type: \"text\"\n    },\n    \t{\n        name: \"🌐网址发布\",\n        type: \"button\",\n        action: \"fabuye()\",\n        style: {\n            \"layout_flexGrow\": 0,\n            \"layout_flexBasisPercent\": -1,\n            \"layout_wrapBefore\": true\n        }\n    }\n]`",
  "loginUrl": "function login() {}\n\nfunction fabuye(){\n\tlet fbyu = source.get('fbyu')+'';\n\tlet headers = JSON.parse(eval(source.header.replace('@js:','')+''));\n\ttry {java.head(fbyu,headers);}\n\tcatch(e) {fbyu='https://mm18vc.com';}\n\tlet webr = java.startBrowserAwait(fbyu,'发布页',false).body();\n\tlet rr = org.jsoup.Jsoup.parse(webr);\n\tfbyu = rr.select('.list:nth-of-type(3) a').attr('href')+'';\n\tsource.put('fbyu',fbyu);\n\tlet surl = (rr.select('.list:nth-of-type(6) a').attr('href')+'').replace('http://','https://');\n\ttry {java.head(surl,headers);\n\tjava.longToast('已记录最新网址\\n'+surl);\n\tlet Info=source.getLoginInfoMap()||{};\n\tInfo['网址'] = surl;\n\tcache.putMemory('av18info',Info);\n\tsource.putLoginInfo(JSON.stringify(Info));\t\n} catch(e) {java.longToast('得到的网址\\n'+surl+'\\n无法访问，不进行记录');}\n}\n\nfunction bfq(){\njava.toast('\\n正在更新播放器...');\njava.deleteFile('dcc1a0ac99b90ead.js');\nlet [,bb]=java.cacheFile('https://unpkg.com/artplayer/dist/artplayer.js').match(/artplayer.js.*v(.+)/i);\njava.longToast('\\n当前版本号：V'+bb);\n\t}\n\nfunction bfqfun(x,y) {\nlet xx = source.get('av'+x)||1;\nif (y) return xx==1\n//默认开启\nif(xx!=1) {source.put('av'+x,1);java.toast('🟢已开启 '+x);}\nelse {source.put('av'+x,2);java.toast('⚫已关闭 '+x);}\n\t}\nfunction bfqfun2(x,y) {\nlet xx = source.get('av'+x);\nif (y) return xx==1\n//默认关闭\nif(xx!=1) {source.put('av'+x,1);java.toast('🟢已开启 '+x);}\nelse {source.put('av'+x,0);java.toast('⚫已关闭 '+x);}\n\t}\nfunction bfqfun3(x,y) {\nlet xx = (source.get('av'+x)+'')||1;\nlet xs = [\"0️⃣\",\"1️⃣\",\"2️⃣\",\"3️⃣\",\"4️⃣\",\"5️⃣\",\"6️⃣\",\"7️⃣\",\"8️⃣\",\"9️⃣\"];\nif (y<=1) return xs[xx];\n//等级调节\nxx= xx==1?y+1:xx;\nif (xx>1) {\n\txx--;\n\tsource.put('av'+x,xx);\n\tjava.toast('🔵'+x+'：'+xx+'级');}\n}\n",
  "ruleArticles": "<js>\nlet url = java.hexDecodeToString(result)+'';\nurl=surl()+url.replace(/^http.{4}[^\\/]+/,'');\nlet webrh=cache.get(url)+'';\nif (webrh.length<6999) {\nwebrh=java.ajax(url);\nwebrh=rrcheck(url, webrh);\nlet webr = org.jsoup.Jsoup.parse(webrh);\nwebr = webr.select('.posts>.post');\nif (webr=='') {result=[];}\nelse {\n\tlet fmurl = webr.first().select(\"img\").attr(\"src\");\nif (fmurl=='') {result=[];}\nelse {\n\t//正确网络加载\n\tresult=webr;\n\tlet cfm=true;\nif (/animation_list\\/all|dt_list\\/all/.test(url)) {\ncache.put(url,webrh,3600*24*3);}\nelse if (/content_news\\/all/.test(url)) {\n\tlet fmurlmr = result.get(1)?.select(\"img\").attr(\"src\");\nsource.put('fmurlmr',fmurlmr);\ncache.put(url,webrh,3600*24*2);}\nelse if (/fc_search\\/all/.test(url)) {\ncache.put(url,webrh,3600*24*2);}\nelse if (/uncensored_list\\/all|chinese_list\\/all/.test(url)) {\ncache.put(url,webrh,3600*24);}\nelse {\n\tif (!url.includes(\"_random\")) {\n\tcfm=false;\n\tswitch (String(Date.now()).substr(-1)) {\n\tcase \"1\": source.put('fmsj1',fmurl);break;\n\tcase \"2\": source.put('fmsj2',fmurl);break;\n\tcase \"3\": source.put('fmsj3',fmurl);break;}\n\t}\ncache.put(url,webrh,3600*4);\n//其他分类\n}\n\nif (cfm) source.put('fm'+url,fmurl);\n//有封面\n}\n//有dom\n}\n//没缓存\n} else {\n\tlet mk=cache.getFromMemory(url+'2')||0;\n\tcache.putMemory(url+'2',mk+1);\n\tlet tmh = new Date().getHours();\n\tif (/content_news\\/all|animation_list\\/all|fc_search\\/all/.test(url)) {\n\t\tmk>3&&cache.delete(url);}\n\telse if (mk>1||tmh>1&&tmh<4) {\n\t\tcache.deleteMemory(url+'2');\n\t\tcache.delete(url);}\n\t\twebrh = org.jsoup.Jsoup.parse(webrh);\n\t\tresult = webrh.select('.posts>.post');\t\t\n}\nresult\n</js>",
  "ruleContent": "<js>\nlet uu=java.hexDecodeToString(result)+'';\r\nresult=uu.replace(/[\\/\\.\\_\\-\\s]|html$/g,'');\r\nlet ssurl = surl();\r\n  let url = ssurl + uu;\r\n  if (uu.startsWith(\"http\")) url=uu;\r\n  let webr=cache.get(url)+'';\r\n  if (webr.length<6999) {\r\n  webr = java.ajax(url);\r\n  webr = rrcheck(url, webr);\r\n  cache.put(url,webr,3600*24*20);}\r\n  let title = gets('h1.0@text', webr);\r\n  let pimg = gets('#player-wrap img@src', webr);\r\n  let yimgs = gets('.ut1_img_content_smallcg@html', webr);\r\n  let jianjie = gets('.posts-inner-details-text,.actor-right-details-images,.posts-inner-details-text@html', webr).replaceAll('https://pics.','http://cdn.cdnjson.com/pic.html?url=pics.');\r\n  let posts=org.jsoup.Jsoup.parse(webr).select('.video .posts');\r\n  posts.select('video').remove();\r\n\r\nlet pyer=source.get('av外置播放器')==1;\r\n\t// 设置Cookie\r\nlet cks=(source.getLoginHeader()+'').split(/;\\s*/);\r\nlet ckjs='';\r\nfor (let ck of cks) {\r\n\tif (ck) ckjs+=`document.cookie = \"${ck}; path=/\";\r\n`;}\r\n\r\n\tresult=`\r\n  <!DOCTYPE html>\r\n  <html lang=\"zh-CN\">\r\n  \r\n  <head>\r\n    <meta charset=\"UTF-8\">\r\n    <title>${rssArticle.sort}</title>\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\r\n    <style>\r\n      * {\r\n        margin: 0;\r\n        padding: 0;\r\n        box-sizing: border-box;\r\n      }\r\n      html,\r\n      body {\r\n        width: 100%;\r\n        overflow-x: hidden;\r\n        overflow-wrap: break-word;\r\n        word-break: break-all;\r\n      }\r\n      .artplayer-app {\r\n      \taspect-ratio: 16/9;\r\n      }\r\n      .ut1_img_content_smallcg {\r\n        display: flex;\r\n        flex-wrap: wrap;\r\n        line-height: 0;\r\n        justify-content: space-between;\r\n      }\r\n      .img_smallcg img {\r\n        width: 50vw;\r\n        height: auto;\r\n      }\r\n      .posts-inner-details-text-top {\r\n        display: flex;\r\n        flex-wrap: wrap;\r\n      }\r\n      .posts-inner-details-text-left ul {\r\n        display: flex;\r\n        width: 50vw;\r\n        flex-wrap: wrap;\r\n      }\r\n      .posts-inner-details-text-left li {\r\n        width: 25vw;\r\n        list-style: none;\r\n        flex-wrap: wrap;\r\n      }\r\n      .posts-inner-details-text-under li span {\r\n        margin-right: 1ex;\r\n      }\r\n      h3 {\r\n        margin: 1ex;\r\n      }\n      .posts {\n      \tmax-height: 0;\n      \toverflow: hidden;\n      \t}\n      \t.posts.active {\n      \tmax-height: max-content;\n      \t}\r\n    </style>\r\n  </head>\r\n  \r\n  <body>\r\n    <div class=\"artplayer-app\"></div>\r\n    <div class=\"jianjie\">\r\n    <h3>${title}</h3>\r\n    ${source.get('av预览截图')!=2?yimgs:''}\r\n    ${jianjie}\n    <div id=\"pyurl\"></div>\r\n    <br>\r\n    </div>\r\n    <h2 onclick=\"sjzt()\" style=\"text-align: center;\">▼随机主题▼</h2>\r\n    ${posts}\n    <br>\n    <br>\r\n    <script>\nconst posts=document.querySelector('.posts');\nfunction sjzt() {\n\tposts.classList.toggle('active');\n\t}\nconst outp=${source.get('av外置播放器')==1};\r\nconst jjm=\\`\r\nlet srcurl = source.get(\"av18${result}\") + '';\r\nif (!srcurl) {\r\n    let webjs = \"jfun_show_vfc();$('body .main .container_small center').html()\";\r\n  try {\r\n    webr = java.webView(cache.get(\"${url}\"), \"${url}\", webjs);\r\n  } catch(err) {webr='';}\r\n    srcurl = webr.match(/\\\\\\\\/\\\\\\\\/[^\"']+js\\\\\\\\/player\\\\\\\\/[^\"']+php\\\\\\\\?id=100_([^\"'_]+)_([^\"']+)/);\r\n    if (srcurl) {\r\n        srcurl = \"/\"+srcurl[1]+\"/\"+srcurl[2]+\"/\"+srcurl[2]+\".m3u8\";\r\n        source.put(\"av18${result}\", srcurl);\r\n    }\r\n  }\r\nif (!srcurl) {\r\ncache.delete(\"${url}\");\r\njava.longToast('💔未获取到播放链接');}\r\nelse if (/18av\\\\.mm\\\\-/.test(\"${ssurl}\"))\r\n\tsrcurl = \"https://v.imgstream2.com\"+ srcurl;\r\nelse\r\n\tsrcurl = \"${ssurl}\".replace('//', '//fc.') + srcurl;\r\nsrcurl\\`;\r\n\r\nfunction setting() {\n\tlet art = new Artplayer({\r\n        container: '.artplayer-app',\r\n        poster: '${pimg}',\r\n        id: '${result}',\r\n        theme: '#ffad00',\r\n        autoplay: ${source.get('av自动播放')==1?true:false},\r\n        muted: false,\r\n        fullscreen: true,\r\n        autoSize: true,\r\n        autoMini: false,\r\n        playbackRate: true,\r\n        setting: true,\r\n        lock: true,\r\n        gesture: true,\r\n        fastForward: true,\r\n        autoPlayback: ${source.get('av继续播放')!=2?true:false},\r\n        autoOrientation: true,\r\n      });\r\n    Artplayer.PLAYBACK_RATE = [0.75, 1, 2, 4, 6];\r\n    Artplayer.FAST_FORWARD_TIME = 500;\r\n    Artplayer.MOBILE_DBCLICK_PLAY = false;\r\n    Artplayer.TOUCH_MOVE_RATIO = 0.${source.get('av左右滑动等级')+''||'5'};\r\n   \r\nart.on('dblclick', (event) => {\r\n\t const tmz = +\"${tmtz()}\";\r\n\t\tconst clix = event.clientX;\r\n\t\tconst rwid = art.rect.width;\r\n\t if (clix < rwid / 3) art.backward = tmz;\r\n\t else if (clix > rwid * 2 / 3) art.forward = tmz;\r\n\t else art.toggle();\r\n});\r\nart.once('ready', () => {\r\nlet lo=localStorage.getItem(\"artplayer_settings\")+'';\r\nlet slo=\\`${source.get('localS')}\\`;\r\nif (slo.length>lo.length)\r\nlocalStorage.setItem(\"artplayer_settings\",slo);\nelse\r\nwindow.location.href = \"yuedu://setvar/\" + encodeURIComponent(lo);\r\n});\nreturn art;\r\n}\r\nasync function init () {\n\tawait new Promise(resolve => {\n  const checkRun = () => {\n    if (typeof window.run === 'function') resolve();\n    else setTimeout(checkRun, 50);\n   };\n   checkRun();\n});\n\nconst r = await window.run(\"java.importScript('https://unpkg.com/artplayer/dist/artplayer.js')\");\neval(r);\nvar art;\nif (!outp) art = setting();\nconst u = await window.run(jjm);\nif (!outp) art.url = u;\nif (${source.get('av显示链接')!=2})\ndocument.getElementById(\"pyurl\").innerHTML=\\`<p>播放链接：<span>\\${u}</span><button onclick=\"copyText(this,'before')\" style=\"margin-left: 2ex;\">⎘复制</button></p>\\`;\nif (outp) window.run(\"java.openUrl('\"+u+\"','video/*')\");\r\n\t}\r\nsetTimeout(init, 50);\r\n</script>\r\n<script>\r\n${ckjs}\r\nfunction copyText(button, weizi) {\r\nconst text = weizi == 'before' ?\r\nbutton.previousElementSibling.textContent :\r\nweizi == 'after' ? button.nextElementSibling.textContent :\r\n'异常';\r\n    const btext = button.textContent;\r\n    navigator.clipboard.writeText(text)\r\n        .then(() => {\r\n            button.textContent = \"✓已复制\";\r\n            setTimeout(() => {\r\n                button.textContent = btext;\r\n            }, 1500);\r\n        })\r\n        .catch(err => {\r\n            button.textContent = \"✗失败\";\r\n            setTimeout(() => {\r\n                button.textContent = btext;\r\n            }, 1500);\r\n        });\r\n}\n\r\nvar pressTimer = null;\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n\n\r\ndocument.querySelector('.jianjie').addEventListener('touchstart', (e) => {\n\tlet ee=e.target;\r\n\tif (ee.tagName=='A')\r\n\tpressTimer = setTimeout(() => {\r\n\t\tlet txt=ee.textContent+\"::\"+ee.href;\r\nnavigator.clipboard.writeText(txt).then(()=>{alert(\"已复制到剪贴板，可填在登录界面的自定义分类或搜索处。\\\\n\\\\n\"+txt);});\r\n}, 1200);\r\n});\r\n  \r\ndocument.querySelector('.jianjie').addEventListener('touchend', e => {\r\n\tif (pressTimer) {\r\n\t\tclearTimeout(pressTimer);\r\n\t\tpressTimer = null;}\r\n});\n\ndocument.querySelector('.jianjie').addEventListener('click', e => {\n\tlet ee=event.target.closest('a');\n\tif (ee) {\n\t\te.preventDefault();\n\t\tlet url=ee.href;\n\t\tlet tt=ee.textContent;\n\t\tif (!tt) {\n\t\t\tlet a=ee.nextElementSibling.querySelector('a');\n\t\t\tif (a) tt=a.textContent;\n\t\t\t}\n\t\twindow.openui(\"sort\",{[tt]:\\`data:;base64,\\{\\{java.base64Encode(\"\\${url.replace(/[^\\\\\\\\/].html/,'')}\"+page+\".html\")\\}\\},{\"type\":\"18av\"}\\`});\n\t\t}\r\n});\n\ndocument.querySelector('.posts').addEventListener('click', e => {\n\tlet ee=event.target.closest('a');\n\tif (ee) {\n\t\te.preventDefault();\n\t\tlet tt=ee.innerText;\n\t\tif (!tt) {\n\t\t\tlet h3=ee.parentElement.nextElementSibling.querySelector('h3');\n\t\t\tif (h3) tt=h3.textContent;\n\t\t\t}\twindow.openui(\"rss\",{[tt]:\\`\\${ee.href}@js:'data:;base64,\\${btoa(ee.href.replace(/^http.{4}[^\\/]+/,''))},{\"type\":\"18av\"}'\\`});\n\t\t}\r\n});\n\n\n});\r\n</script>\r\n  </body>\r\n  </html>\r\n  `;\n</js>",
  "ruleImage": "img@src",
  "ruleLink": "a.0@href\n<js>\nlet url=java.base64Encode(result.replace(/^http.{4}[^\\/]+/,''));\nresult+`@js:'data:;base64,${url},{\"type\":\"18av\"}'`;\n</js>",
  "ruleNextPage": "page",
  "rulePubDate": ".con .meta@text",
  "ruleTitle": ".con a@text",
  "shouldOverrideUrlLoading": "if (url.startsWith('yuedu://setvar/')) {\tsource.put('localS',decodeURIComponent(url.replace('yuedu://setvar/','')));\ntrue\n}\nelse if (url.includes(\"/chinese_category/\")) {\n\tjava.open(\"sort\",`data:;base64,{{java.base64Encode(\"${url.replace(/[^\\\\/].html/,'')}\"+page+\".html\")}},{\"type\":\"18av\"}`);\n\ttrue\n}\nelse false",
  "showWebLog": true,
  "singleUrl": false,
  "sortUrl": "<js>\r\nlet banben=\"1.0.9\";\nlet fkey = (source.getLoginInfoMap()['自定义分类']||'')+'';\nfkey=fkey.trim().split(/\\s+/).map(x=>x\n\t.replace(/::https.{3}[^\\/]+/,'::data:;base64,{{java.base64Encode(\"')\n\t.replace(/(?:\\d+|page)\\.html$/,'\"+page+\".html\")')\n\t.replace(/(?:index)\\.html$/,'index.html?t=\"+page)') + '}},{\"type\":\"18av\"}').join('\\n');\n`中文字幕::data:;base64,{{java.base64Encode(\"/zh/chinese_list/all/\"+page+\".html\")}},{\"type\":\"18av\"}\n无码AV::data:;base64,{{java.base64Encode(\"/zh/uncensored_list/all/\"+page+\".html\")}},{\"type\":\"18av\"}\nH动漫::data:;base64,{{java.base64Encode(\"/zh/animation_list/all/\"+page+\".html\")}},{\"type\":\"18av\"}\n搜索1::data:;base64,{{java.base64Encode(((y=skey(1).match(/\\\\/zh\\\\/.+(?=\\\\/1.html)/))?y[0]:(\"/zh/fc_search/all/\"+skey(1)))+\"/\"+page+\".html\")}},{\"type\":\"18av\"}\n搜索2::data:;base64,{{java.base64Encode(((y=skey(2).match(/\\\\/zh\\\\/.+(?=\\\\/1.html)/))?y[0]:(\"/zh/fc_search/all/\"+skey(2)))+\"/\"+page+\".html\")}},{\"type\":\"18av\"}\n每日更新::data:;base64,{{java.base64Encode(\"/zh/content_news/all/\"+tkey()+\".html\")}},{\"type\":\"18av\"}\n随机近作::data:;base64,{{java.base64Encode(\"/zh/chinese_random/all/index.html?t=\"+page)}},{\"type\":\"18av\"}\n随机所有::data:;base64,{{java.base64Encode(\"/zh/chinese_randomall/all/index.html?t=\"+page)}},{\"type\":\"18av\"}\n${fkey}\n国产自拍::data:;base64,{{java.base64Encode(\"/zh/dt_list/all/\"+page+\".html\")}},{\"type\":\"18av\"}\n`</js>",
  "sourceGroup": "🙈",
  "sourceIcon": "https://gitee.com/lyc486/yuedu/raw/master/0GP0yD.gif",
  "sourceName": "18AV",
  "sourceUrl": "https://18av.luoyacheng.ip-ddns.com",
  "startHtml": "@js:\nlet su=surl();\nlet zm=source.get('fm'+su+\"/zh/chinese_list/all/1.html\")+'';\nlet wm=source.get('fm'+su+\"/zh/uncensored_list/all/1.html\")+'';\nlet sjd=source.get('fm'+su+\"/zh/chinese_random/all/index.html?t=1\")+'';\nlet sja=source.get('fm'+su+\"/zh/chinese_randomall/all/index.html?t=1\")+'';\nlet sjm=source.get('fm'+su+\"/zh/animation_random/all/index.html?t=1\")+'';\nlet gc=source.get('fm'+su+\"/zh/dt_list/all/1.html\")+'';\nlet dm=source.get('fm'+su+\"/zh/animation_list/all/1.html\")+'';\nlet mr=source.get('fmurlmr')+'';\nlet fmsj1=source.get('fmsj1')+'';\nlet fmsj2=source.get('fmsj2')+'';\n\n`<html>\r\n\r\n<head>\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=no\">\r\n    <title>18AV</title>\r\n</head>\r\n\r\n<body>\r\n    <div class=\"container\">\r\n        <form id=\"ss\">\r\n            <input type=\"text\" name=\"key\" id=\"searchkey\" placeholder=\"输入关键词\">\r\n            <button type=\"submit\">搜 索</button>\r\n        </form>\n        \n<div class=\"history-container\">\n <div class=\"history-header\">\n<div class=\"history-title\">搜索历史</div>\n<button id=\"clearHistory\">清除记录</button>\n</div>\n<div id=\"historyList\"></div>\n</div>\n        \r\n        <div id=\"fl\">\r\n            <div onclick=\"ff('中文字幕')\">${zm?`<img src=\"${zm}\" alt=\"暂无图片\">`:''}<span>中文字幕</span></div>\r\n            <div onclick=\"ff('高清无码')\">${wm?`<img src=\"${wm}\" alt=\"暂无图片\">`:''}<span>高清无码</span></div>\n            <div onclick=\"ff('动画动漫')\">${dm?`<img src=\"${dm}\" alt=\"动画动漫\">`:''}<span>动画动漫</span></div>\r\n            <div onclick=\"ff('随机近作')\">${sjd?`<img src=\"${sjd}\" alt=\"暂无图片\">`:''}<span>随机近作</span></div>\r\n            <div onclick=\"ff('随机所有')\">${sja?`<img src=\"${sja}\" alt=\"暂无图片\">`:''}<span>随机所有</span></div>\n            <div onclick=\"ff('随机动漫')\">${sjm?`<img src=\"${sjm}\" alt=\"暂无图片\">`:''}<span>随机动漫</span></div>\n            <div onclick=\"ff('每日更新')\">${mr?`<img src=\"${mr}\" alt=\"暂无图片\">`:''}<span>每日更新</span></div>\r\n            <div onclick=\"ff('国产自拍')\">${gc?`<img src=\"${gc}\" alt=\"暂无图片\">`:''}<span>国产自拍</span></div>\r\n            <div onclick=\"ff('自选分类')\">${fmsj2?`<img src=\"${fmsj2}\" alt=\"暂无图片\">`:''}<span>自选分类</span></div>\r\n            <div onclick=\"window.location.href='${su}/zh/chinese_categorylist/list/index.html'\">${fmsj1?`<img src=\"${fmsj1}\" alt=\"暂无图片\">`:''}<span>分类清单</span></div>\r\n        </div>\r\n        <div class=\"bottom-line\"></div>\r\n    </div>\r\n</body>\r\n\r\n</html>`",
  "startJs": "const HISTORY_KEY = 'searchHistory';\nconst MAX_HISTORY_ITEMS = 10;\n        const ss = document.getElementById('ss');\n        const historyList = document.getElementById('historyList');\n        const clearHistoryBtn = document.getElementById('clearHistory');\n        const searchInput = document.getElementById('searchkey');\n        function performSearch(keyword) {\n            if (!(keyword.length>1)) return;\n            addHistoryItem(keyword);\n            searchInput.value=\"\";\n            window.openui(\"sort\", { [keyword]: `data:;base64,{{java.base64Encode(\"/zh/fc_search/all\"+\"/${keyword}/\"+page+\".html\")}},{\"type\":\"18av\"}` });\n        }\n        \r\n        ss.addEventListener('submit', function (event) {\r\n            event.preventDefault();\r\n            const formData = new FormData(ss);\r\n            const key = formData.get('key');\r\n            if (key) {\n            \tperformSearch(key);\n           } else {\n           \tsearchInput.placeholder = \"输入关键词，亲\";\n           searchInput.focus();}\r\n        });\nconst tt = new Intl.DateTimeFormat('zh-CN', {year: 'numeric', month: '2-digit', day: '2-digit'}).format(new Date()).replace(/\\//g, '-');\nconst fl = {\n\t\"中文字幕\":`data:;base64,{{java.base64Encode(\"/zh/chinese_list/all/\"+page+\".html\")}},{\"type\":\"18av\"}`,\n\t\t\"高清无码\":`data:;base64,{{java.base64Encode(\"/zh/uncensored_list/all/\"+page+\".html\")}},{\"type\":\"18av\"}`,\n\t\t\t\"随机近作\":`data:;base64,{{java.base64Encode(\"/zh/chinese_random/all/index.html?t=\"+page)}},{\"type\":\"18av\"}`,\n\t\t\t\t\"随机所有\":`data:;base64,{{java.base64Encode(\"/zh/chinese_randomall/all/index.html?t=\"+page)}},{\"type\":\"18av\"}`,\n\t\t\t\t\t\"国产自拍\":`data:;base64,{{java.base64Encode(\"/zh/dt_list/all/\"+page+\".html\")}},{\"type\":\"18av\"}`,\n\t\t\t\t\t\"每日更新\":`data:;base64,{{java.base64Encode(\"/zh/content_news/all/${tt}.html\")}},{\"type\":\"18av\"}`,\n\t\t\t\t\t\"动画动漫\":`data:;base64,{{java.base64Encode(\"/zh/animation_list/all/\"+page+\".html\")}},{\"type\":\"18av\"}`,\n\t\t\t\t\t\"随机动漫\":`data:;base64,{{java.base64Encode(\"/zh/animation_random/all/index.html?t=\"+page)}},{\"type\":\"18av\"}`\n\t}\n        function ff(n) {\n        \tif (n=='自选分类') {\n        \t\t(async () => {\n        \t\t\tconst fkey = await window.run(\"source.getLoginInfoMap()['自定义分类']\");\n        \t\t\tlet obj = {};\n        \t\t\tif (fkey.length>9) {\n        \t\t\tfkey.trim().split(/\\s+/).forEach(x=> {\n        \t\t\tlet [y1,y2] = x.split('::');\n        \t\t\tobj[y1]=`data:;base64,{{java.base64Encode(\"${y2.replace(/\\d+\\.html$/,'\"+page+\".html\"')})}},{\"type\":\"18av\"}`});\n        \t\twindow.openui(\"sort\", obj);\n        \t\t} else alert(\"请在登录界面填写自定义分类\")\n})();\n        \t\treturn\n        \t\t}\n        \tlet url = fl[n];\n        \tif (url) window.openui(\"sort\", { [n]: url});\n        \t}\r\n\r\n        ss.style.animation = `fadeIn 0.6s ease-out forwards`;\r\n        document.querySelectorAll('#fl > div').forEach((child, index) => {\r\n            child.style.animation = `fadeIn ${0.8 + index * 0.3}s ease-out forwards`;\r\n        });\n        \nfunction loadHistory() {\n return JSON.parse(localStorage.getItem(HISTORY_KEY)) || [];\n}\nfunction saveHistory(history) {\nlocalStorage.setItem(HISTORY_KEY, JSON.stringify(history));\n}\nfunction addHistoryItem(keyword) {\n            let history = loadHistory();\n            history = history.filter(item => item !== keyword);\n            history.unshift(keyword);\n            if (history.length > MAX_HISTORY_ITEMS) {\n                history = history.slice(0, MAX_HISTORY_ITEMS);\n            }\n            saveHistory(history);\n            renderHistory();\n        }\nfunction removeHistoryItem(keyword) {\n            let history = loadHistory();\n            history = history.filter(item => item !== keyword);\n            saveHistory(history);\n            renderHistory();\n        }\nfunction clearHistory() {\n            if (confirm('确定要清除所有搜索历史吗？')) {\n                localStorage.removeItem(HISTORY_KEY);\n                renderHistory();\n            }\n        }\n// 显示历史\n        function renderHistory() {\n            const history = loadHistory();\n            historyList.innerHTML = '';\n            if (history.length === 0) {\n                historyList.innerHTML = '<div class=\"no-history\">暂无搜索历史</div>';\n                return;\n            }\n            \n            history.forEach(keyword => {\n                const item = document.createElement('div');\n                item.className = 'history-item';\n                item.innerHTML = `${keyword}<span class=\"fa-times\" data-keyword=\"${keyword}\">🗑️</span>`;\n                historyList.appendChild(item);\n                \n                // 点击搜索\n                item.addEventListener('click', (e) => {\n                    if (!e.target.classList.contains('fa-times')) {\n                        searchInput.value = keyword;\n                        performSearch(keyword);\n                    }\n                });\n                \n                // 处理删除按钮\n                const deleteBtn = item.querySelector('.fa-times');\n                deleteBtn.addEventListener('click', (e) => {\n                    e.stopPropagation();\n                    removeHistoryItem(keyword);\n                });\n            });\n        }\n\nclearHistoryBtn.addEventListener('click',clearHistory);        \nrenderHistory();\n\n//console.log(document.documentElement.outerHTML);",
  "startStyle": "        * {\r\n            margin: 0;\r\n            padding: 0;\r\n            box-sizing: border-box;\r\n            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;\n            user-select: none;\r\n        }\r\n        ::-webkit-scrollbar {\r\n            display: none;\r\n        }\r\n        body {\r\n            display: flex;\r\n            justify-content: center;\r\n            min-height: 100vh;\r\n            background: linear-gradient(135deg, #617696 0%, #e4edf5 100%);\r\n            padding: 10px 20px 20px 20px;\r\n            color: #333;\r\n        }\r\n        .container {\r\n            width: 100%;\r\n            text-align: center;\r\n            background: rgba(255, 255, 255, 0.86);\r\n            border-radius: 24px;\r\n            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.08);\r\n            position: relative;\r\n            overflow-y: auto;\r\n        }\r\n        .container::before {\r\n            content: '';\r\n            position: absolute;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 28px;\r\n            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);\r\n        }\r\n        .bottom-line {\r\n            width: 100%;\r\n            height: 28px;\r\n            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);\r\n        }\r\n        #ss {\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            margin: 30px auto;\r\n            width: 100%;\r\n            position: relative;\r\n        }\r\n        #ss input[type=\"text\"] {\r\n            width: 60%;\r\n            padding: 0px 20px;\r\n            margin-right: 10px;\r\n            height: 60px;\r\n            font-size: 1.15rem;\r\n            border: 2px solid #e3eef9;\r\n            border-radius: 16px;\r\n            outline: none;\r\n            background: #ffffff;\r\n            color: #2c3e50;\r\n            box-shadow:\r\n                0 5px 20px rgba(0, 0, 0, 0.03),\r\n                inset 0 1px 3px rgba(0, 0, 0, 0.05);\r\n            transition: all 0.3s ease;\r\n        }\r\n        #ss input[type=\"text\"]::placeholder {\r\n            color: #b0c1d3;\r\n            font-weight: 400;\r\n        }\r\n        #ss input[type=\"text\"]:focus {\r\n            border-color: #4facfe;\r\n            box-shadow:\r\n                0 8px 25px rgba(79, 172, 254, 0.15),\r\n                inset 0 1px 3px rgba(0, 0, 0, 0.03);\r\n        }\r\n        #ss button {\r\n            position: relative;\r\n            width: 30%;\r\n            height: 40px;\r\n            padding: 0px;\r\n            font-size: 1.1rem;\r\n            font-weight: 600;\r\n            border: none;\r\n            border-radius: 12px;\r\n            background: linear-gradient(90deg, #3f8abc 0%, #177eae 100%);\r\n            color: white;\r\n            transition: all 0.3s ease;\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n        }\r\n        #ss button:hover {\r\n            background: linear-gradient(90deg, #4290d4 0%, #1c98d2 100%);\r\n            transform: translateY(-2px);\r\n        }\r\n        #ss button:active {\r\n            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);\r\n            transform: translateY(1px);\r\n        }\r\n        #ss button i {\r\n            margin-right: 10px;\r\n            font-size: 1rem;\r\n        }\r\n        #fl {\r\n            display: flex;\r\n            flex-direction: column;\r\n            justify-content: center;\r\n            align-items: center;\r\n        }\r\n        #fl>div {\r\n            width: 300px;\r\n            aspect-ratio: 16/9;\r\n            overflow: hidden;\r\n            /* 约束图片高度 */\r\n            border: 2px dotted;\r\n            margin-bottom: 10px;\r\n            position: relative;\r\n        }\r\n        #fl>div>span {\r\n            display: block;\r\n            position: absolute;\r\n            top: 3%;\r\n            right: 3%;\r\n            font-weight: bold;\r\n            font-family: 'Impact', 'Arial Black', cursive, sans-serif;\n            font-size:0.5rem;\r\n            text-shadow: 2px 2px 6px #333, 0 0 20px #1c98d2;\r\n            background-color: rgba(191, 220, 245, 0.6);\r\n            border-radius: 20px;\r\n            padding: 5px 10px;\r\n        }\r\n        #fl>div>img {\r\n            width: 100%;\r\n            height: 100%;\r\n            display: block;\r\n            object-fit: cover;\r\n            object-position: center center;\r\n            filter: brightness(0.9);\r\n        }\r\n        @keyframes fadeIn {\r\n            from {\r\n                opacity: 0;\r\n                transform: translateY(20px);\r\n            }\r\n            to {\r\n                opacity: 1;\r\n                transform: translateY(0);\r\n            }\r\n        }\n\n.history-container {\n            width: 90%;\n            max-width: 700px;\n            margin: 0 auto 25px;\n            padding: 15px;\n            background: rgba(255, 255, 255, 0.95);\n            border-radius: 16px;\n            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);\n            text-align: left;\n            animation: fadeIn 0.5s ease-out forwards;\n        }\n        .history-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 12px;\n            padding-bottom: 10px;\n            border-bottom: 1px solid #eaeaea;\n        }\n        .history-title {\n            font-size: 1.2rem;\n            font-weight: 600;\n            color: #2c3e50;\n            display: flex;\n            align-items: center;\n        }\n        #clearHistory {\n            background: none;\n            border: none;\n            color: #888;\n            font-size: 0.9rem;\n            cursor: pointer;\n            display: flex;\n            align-items: center;\n            transition: color 0.2s;\n        }\n        #clearHistory:hover {\n            color: #ff6b6b;\n        }\n        #historyList {\n            display: flex;\n            flex-wrap: wrap;\n            gap: 10px;\n        }\n        .history-item {\n            background: rgba(79, 172, 254, 0.1);\n            border: 1px solid rgba(79, 172, 254, 0.3);\n            border-radius: 50px;\n            padding: 8px 16px;\n            font-size: 0.95rem;\n            transition: all 0.2s;\n            color: #3f8abc;\n            display: flex;\n            align-items: center;\n        }\n        .history-item:hover {\n            background: rgba(79, 172, 254, 0.2);\n            transform: translateY(-2px);\n            box-shadow: 0 3px 8px rgba(79, 172, 254, 0.2);\n        }\n.fa-times {\n\tpadding-left: 10px;\n\t}"
}]